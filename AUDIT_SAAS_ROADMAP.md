# AUDIT & SaaS ROADMAP: Admin Panel –¥–ª—è LDM Steel

## üìã –ê–£–î–ò–¢ –ü–†–û–ï–ö–¢–ê

### ‚úÖ –î–û–°–¢–û–ò–ù–°–¢–í–ê –¢–ï–ö–£–©–ï–ô –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ & –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Next.js 16** (App Router) + **Turbopack** ‚Üí –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **TypeScript 5** ‚Üí –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤)
- **Tailwind CSS v4** + **Radix UI** ‚Üí –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π UI
- **Prisma v7** + **PostgreSQL** ‚Üí –Ω–∞–¥—ë–∂–Ω–∞—è –ë–î —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- **React Hook Form** + **Zod** ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –∏ –±–µ–∫–µ
- **Zustand** ‚Üí –ø—Ä–æ—Å—Ç–æ–π state management (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Redux)
- **React Query** (@tanstack/react-query) ‚Üí —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å & –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- JWT access tokens (1 —á–∞—Å) + refresh tokens (7 –¥–Ω–µ–π) ‚Üí —Ö–æ—Ä–æ—à–∞—è —Å—Ö–µ–º–∞
- Rate limiting (Upstash) ‚Üí –∑–∞—â–∏—Ç–∞ –æ—Ç brute-force
- Password hashing (bcryptjs) ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- Device tracking ‚Üí –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
- Activity logging ‚Üí –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Cookie-based tokens —Å `httpOnly` —Ñ–ª–∞–≥–æ–º ‚Üí –∑–∞—â–∏—Ç–∞ –æ—Ç XSS

#### UI/UX

- Responsive –¥–∏–∑–∞–π–Ω (Tailwind)
- Dark sidebar —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- –¢–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π, –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (Radix Dialog)
- Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (react-hot-toast)
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV

---

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò –ù–ï–î–û–°–¢–ê–¢–ö–ò

#### 1. **–ù–ï–°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨ –†–û–õ–ï–ô** (BUG)

```
DB: role = 'ADMIN' (UPPERCASE)
Client: user?.role !== 'admin' (LOWERCASE)
Middleware: user.role !== 'ADMIN' (UPPERCASE)
```

**–†–µ—à–µ–Ω–∏–µ:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç (–≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏ –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UPPERCASE –≤–µ–∑–¥–µ (–∫–∞–∫ –≤ enum UserRole)

#### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ .env.example –∏ BASE_URL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

- –ù–µ—Ç –ø—Ä–∏–º–µ—Ä–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Üí –Ω–æ–≤—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è
- BASE_URL —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `headers()` ‚Üí –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
- SITE_URL —Ç–æ–ª—å–∫–æ –≤ auth-tokens.ts –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `secure` cookie

**–†–µ—à–µ–Ω–∏–µ:**

```env
# .env.example
DATABASE_URL=postgresql://user:password@localhost:5432/admin-panel
JWT_SECRET=your-secret-key-min-32-chars
NODE_ENV=development
NEXT_PUBLIC_BASE_URL=http://localhost:3000  # –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=
```

#### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤**

- –¢–æ–ª—å–∫–æ `proxy.ts` (middleware), –Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è `/admin/*`
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ API endpoints (401/403 –Ω–∞ –∫–∞–∂–¥–æ–º)
- –ù–µ—Ç centralized error handling –¥–ª—è API

#### 4. **Form Validation –•–∞–æ—Å**

- `auth.ts` —Å–æ–¥–µ—Ä–∂–∏—Ç `loginSchema` (8+ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
- `login-form-schema.ts` —Å–æ–¥–µ—Ä–∂–∏—Ç `loginFormSchema` (3+ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –≤—Ö–æ–¥–∞)
- **–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —Å 8+ —Å–∏–º–≤–æ–ª–∞–º–∏, –Ω–æ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ —Å 3+

**–†–µ—à–µ–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

#### 5. **Product API –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

```ts
// app/api/products/route.ts
if (!body.name || !body.price) { ... }  // –ù–µ—Ç Zod –≤–∞–ª–∏–¥–∞—Ü–∏–∏!
const product = await prisma.product.create({ data: body });  // –ú–∞—Å—Å–æ–≤–æ–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ!
```

- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∫—Ç–æ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã?)
- –ù–µ—Ç rate limiting –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö

#### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¢–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

- –ù–µ—Ç —Ç–∏–ø–æ–≤ –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤ (Typescript `unknown`)
- React Query –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã
- –ù–µ—Ç OpenAPI/Swagger –¥–ª—è API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## –¢–£–¢ –ü–†–û–î–û–õ–ñ–ò–¢–¨

#### 7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**

- –í—Å–µ API requests –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç `cache: 'no-store'` ‚Üí –Ω–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö
- –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –ë–î –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è (email, userId)

#### 8. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ & CI/CD**

- –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤
- –ù–µ—Ç E2E —Ç–µ—Å—Ç–æ–≤ (Playwright/Cypress)
- –ù–µ—Ç GitHub Actions –¥–ª—è CI (lint, test, build)
- –ù–µ—Ç pre-commit hooks (husky)

#### 9. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ & –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

- `console.log/error` –≤–µ–∑–¥–µ (–Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Sentry –¥–ª—è –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤

#### 10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Dokumentation**

- –ù–µ—Ç README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –∑–∞–ø—É—Å–∫—É –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- –ù–µ—Ç API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ù–µ—Ç guide'–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

---

## üöÄ ROADMAP: –†–ê–ó–í–ò–¢–ò–ï –í SaaS –°–¢–ò–õ–¨

### PHASE 1: –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø & –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ë–ê–ì–û–í (1-2 –Ω–µ–¥–µ–ª–∏)

#### Task 1.1: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–æ–ª–∏

- [ ] –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç: `ADMIN` –∏–ª–∏ `admin` (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: `ADMIN`, –∫–∞–∫ –≤ `enum UserRole`)
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –≤–µ–∑–¥–µ (DB, API, Client, Middleware)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏: `user?.role === 'ADMIN'`
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

#### Task 1.2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

- [ ] –°–æ–∑–¥–∞—Ç—å `.env.example` —Å–æ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- [ ] –í—ã–Ω–µ—Å—Ç–∏ BASE_URL –≤ `NEXT_PUBLIC_BASE_URL` –∏ `SITE_URL` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- [ ] –°–æ–∑–¥–∞—Ç—å `lib/config.ts` –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ñ–∏–≥-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∑–¥–µ –≤–º–µ—Å—Ç–æ `process.env.XXX`

#### Task 1.3: –ó–∞—â–∏—Ç–∏—Ç—å API endpoints

- [ ] –°–æ–∑–¥–∞—Ç—å middleware/decorator –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT –Ω–∞ –≤—Å–µ—Ö API routes
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `handleApiError()` –¥–ª—è –æ—à–∏–±–æ–∫ 401/403/500
- [ ] –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ request bodies —Å Zod

#### Task 1.4: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º

- [ ] –°–æ–∑–¥–∞—Ç—å `shared/lib/validation/schemas.ts` —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏
  - `passwordSchema` (8+ —Å–∏–º–≤–æ–ª–æ–≤, —Ö–æ—Ç—è –±—ã 1 —á–∏—Å–ª–æ –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª)
  - `emailSchema` (email validation)
  - `userSchema` (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∑–¥–µ (auth, forms, API)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

#### Task 1.5: –ó–∞—â–∏—Ç–∏—Ç—å Product API

- [ ] –î–æ–±–∞–≤–∏—Ç—å Zod –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è POST/PUT
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: —Ç–æ–ª—å–∫–æ ADMIN –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

#### Task 1.6: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é React Query

- [ ] –°–æ–∑–¥–∞—Ç—å `shared/api/types.ts` —Å —Ç–∏–ø–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å React Query hooks –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `shared/api/client.ts` ‚Äî wrapper –Ω–∞–¥ fetch —Å —Ç–∏–ø–∞–º–∏

---

### PHASE 2: SaaS –û–°–ù–û–í–´ (2-3 –Ω–µ–¥–µ–ª–∏)

#### Task 2.1: –ú—É–ª—å—Ç–∏-—Ç–∞–µ–Ω—Ç–Ω–æ—Å—Ç—å

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ schema.prisma:

  ```prisma
  model Tenant {
    id              String   @id @default(cuid())
    name            String
    slug            String   @unique
    logo            String?
    createdAt       DateTime @default(now())
    users           User[]
    products        Product[]
    orders          Order[]
  }

  model User {
    // ...existing
    tenantId        String
    tenant          Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
    @@index([tenantId])
  }
  ```

- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è: –ø—Ä–∏–≤—è–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ default tenant
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ queries: `where: { tenant: { id: tenantId } }`
- [ ] –î–æ–±–∞–≤–∏—Ç—å middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π tenant –≤–∏–¥–µ—Ç—å

#### Task 2.2: RBAC (Role-Based Access Control)

- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å roles: `OWNER`, `ADMIN`, `MANAGER`, `USER`
- [ ] –°–æ–∑–¥–∞—Ç—å permission matrix:
  ```ts
  const permissions = {
    OWNER: ['all'],
    ADMIN: ['manage_users', 'manage_products', 'view_analytics'],
    MANAGER: ['manage_products', 'view_analytics'],
    USER: ['view_products'],
  };
  ```
- [ ] Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: `requirePermission('manage_users')`
- [ ] UI: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∞–≤

#### Task 2.3: Invite —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- [ ] –°–æ–∑–¥–∞—Ç—å `InvitationToken` –º–æ–¥–µ–ª—å:
  ```prisma
  model InvitationToken {
    id        String   @id @default(cuid())
    tenantId  String
    email     String
    role      UserRole @default(USER)
    token     String   @unique
    expiresAt DateTime
    createdAt DateTime @default(now())
  }
  ```
- [ ] Endpoint: `POST /api/invitations` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
- [ ] Email template –¥–ª—è —Å—Å—ã–ª–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞: `/invite/:token` –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è

#### Task 2.4: –ë–∏–ª–ª–∏–Ω–≥ & –ü–æ–¥–ø–∏—Å–∫–∞ (Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ schema:

  ```prisma
  model Subscription {
    id              String   @id @default(cuid())
    tenantId        String   @unique
    tenant          Tenant   @relation(fields: [tenantId], references: [id])
    plan            String   // 'free' | 'pro' | 'enterprise'
    stripeCustomerId String?
    status          String   // 'active' | 'canceled' | 'past_due'
    currentPeriodEnd DateTime?
  }

  model Invoice {
    id        String   @id @default(cuid())
    tenantId  String
    amount    Int
    status    String
    invoiceUrl String?
    createdAt DateTime @default(now())
  }
  ```

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Stripe SDK
- [ ] Webhook handler –¥–ª—è payment events
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞: `/admin/billing` —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ–¥–ø–∏—Å–∫–æ–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞: features –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–ª–∞–Ω–∞—Ö

#### Task 2.5: Audit Log & Compliance

- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `ActivityLog`:
  ```prisma
  model ActivityLog {
    id        Int      @id @default(autoincrement())
    tenantId  String   // –î–ª—è –º—É–ª—å—Ç–∏-—Ç–∞–µ–Ω—Ç–Ω–æ—Å—Ç–∏
    userId    Int
    action    String   // 'user.created', 'product.updated'
    resource  String   // 'User', 'Product'
    resourceId String?
    changes   Json?    // –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
    ip        String?
    userAgent String?
    createdAt DateTime @default(now())
  }
  ```
- [ ] Endpoint: `GET /api/audit-logs` —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞: `/admin/audit-logs` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

---

### PHASE 3: –ö–ê–ß–ï–°–¢–í–û & PRODUCTION-READY (2-3 –Ω–µ–¥–µ–ª–∏)

#### Task 3.1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] Unit tests (Jest):
  - `auth-tokens.ts` (sign/verify)
  - Validation schemas
  - Utility functions
- [ ] E2E tests (Playwright):
  - Login flow
  - Create user
  - Create product
  - Invite user
- [ ] GitHub Actions workflow:
  ```yaml
  - Run lint
  - Run type check
  - Run tests
  - Build
  - Deploy preview
  ```

#### Task 3.2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ & –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Sentry
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (winston/pino)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LMS (–Ω–∞–ø—Ä–∏–º–µ—Ä, ELK stack)

#### Task 3.3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [ ] README.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
- [ ] ARCHITECTURE.md –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- [ ] API.md —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ endpoints
- [ ] SETUP.md –¥–ª—è new developers

#### Task 3.4: Performance Optimization

- [ ] –î–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å DB queries (–¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã)
- [ ] Lazy loading –¥–ª—è —Ç–∞–±–ª–∏—Ü
- [ ] Image optimization (next/image)

#### Task 3.5: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- [ ] HTTPS –≤ prod–µ (via Vercel –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ö–æ—Å—Ç–∏–Ω–≥)
- [ ] CORS configuration –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- [ ] SQL injection prevention (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Prisma, OK)
- [ ] XSS prevention (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sanitize HTML –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] CSRF tokens –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

---

### PHASE 4: ADVANCED SaaS FEATURES (3-4 –Ω–µ–¥–µ–ª–∏)

#### Task 4.1: Self-Service Portal

- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/dashboard` —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∑–∞–∫–∞–∑–æ–≤
  - –ì—Ä–≤–∞—Ñ–∏–∫–∏ –ø–æ sales, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/settings/profile` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–º
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/settings/security` –¥–ª—è 2FA, sessions

#### Task 4.2: Advanced Notifications

- [ ] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (SendGrid, Resend –∏–ª–∏ Nodemailer)
- [ ] In-app notifications (database + WebSocket –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Notification preferences –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### Task 4.3: Export & Reporting

- [ ] Export users, products, orders –≤ CSV/JSON
- [ ] Generate –æ—Ç—á—ë—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- [ ] Scheduled reports (–æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–∏—Å—å–º–æ–º)

#### Task 4.4: API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

- [ ] Public API —Å API keys
- [ ] Rate limiting per API key
- [ ] Webhooks –¥–ª—è —Å–æ–±—ã—Ç–∏–π (user.created, order.completed)

#### Task 4.5: White-label / Branding

- [ ] –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –ª–æ–≥–æ—Ç–∏–ø–∞, —Ü–≤–µ—Ç–æ–≤ per tenant
- [ ] Custom domain –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üìä –¢–ê–ë–õ–ò–¶–ê –ü–†–ò–û–†–ò–¢–ï–¢–û–í

| Phase | –¢–∞—Å–∫                     | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç  | –î–Ω–∏ | –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è SaaS       |
| ----- | ------------------------ | ---------- | --- | ----------------------- |
| 1     | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–æ–ª–∏       | üî¥ –í–´–°–û–ö–ò–ô | 1   | ‚úÖ –î–∞                   |
| 1     | .env.example & config    | üî¥ –í–´–°–û–ö–ò–ô | 1   | ‚úÖ –î–∞                   |
| 1     | API endpoints –∑–∞—â–∏—Ç–∞     | üî¥ –í–´–°–û–ö–ò–ô | 2   | ‚úÖ –î–∞                   |
| 1     | –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è  | üü† –°–†–ï–î–ù–ò–ô | 1   | ‚úÖ –î–∞                   |
| 1     | Product API –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | üî¥ –í–´–°–û–ö–ò–ô | 1   | ‚úÖ –î–∞                   |
| 2     | –ú—É–ª—å—Ç–∏-—Ç–∞–µ–Ω—Ç–Ω–æ—Å—Ç—å        | üî¥ –í–´–°–û–ö–ò–ô | 5   | ‚úÖ –î–∞                   |
| 2     | RBAC                     | üî¥ –í–´–°–û–ö–ò–ô | 3   | ‚úÖ –î–∞                   |
| 2     | Invite —Å–∏—Å—Ç–µ–º–∞           | üü† –°–†–ï–î–ù–ò–ô | 2   | ‚úÖ –î–∞ (–¥–ª—è —Ä–æ—Å—Ç–∞)       |
| 2     | Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è        | üî¥ –í–´–°–û–ö–ò–ô | 3   | ‚úÖ –î–∞ (–¥–ª—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏) |
| 3     | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ             | üü† –°–†–ï–î–ù–ò–ô | 5   | ‚úÖ –î–∞                   |
| 3     | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥               | üü† –°–†–ï–î–ù–ò–ô | 2   | ‚úÖ –î–∞                   |
| 3     | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è             | üü† –°–†–ï–î–ù–ò–ô | 3   | ‚úÖ –î–∞                   |
| 4     | Self-Service Portal      | üü¢ –ù–ò–ó–ö–ò–ô  | 3   | ‚ùå –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ          |
| 4     | Public API               | üü¢ –ù–ò–ó–ö–ò–ô  | 5   | ‚ùå –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ          |

---

## üîó –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ï –° LDM STEEL

–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **ldm-steel** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

- Products, Orders, Cart
- Users —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π/–≤—Ö–æ–¥–æ–º
- Payment processing

**Admin Panel –¥–æ–ª–∂–µ–Ω:**

1. –£–ø—Ä–∞–≤–ª—è—Ç—å Products (—Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
2. –£–ø—Ä–∞–≤–ª—è—Ç—å Orders (–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞)
3. –£–ø—Ä–∞–≤–ª—è—Ç—å Users (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)
4. –í–µ—Å—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–¥–∞–∂ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
5. –£–ø—Ä–∞–≤–ª—è—Ç—å –ø–ª–∞—Ç–µ–∂–∞–º–∏ (–ø—Ä–∏ Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

**API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

- Admin Panel –∏ LDM Steel –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –ë–î
- –ò–ª–∏: Admin Panel –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î + API –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å LDM Steel

---

## üìù –¢–ò–ü–û–í–û–ô WORKFLOW –†–ê–ó–†–ê–ë–û–¢–ö–ò

### 1Ô∏è‚É£ –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

```bash
git checkout -b feature/role-unification
npm install
npm run prisma:migrate -- --name unify_roles
```

### 2Ô∏è‚É£ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
npm run dev
# –ü–∏—à–∏—Ç–µ –∫–æ–¥
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: npm run test (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ lint: npm run lint
```

### 3Ô∏è‚É£ –ö–æ–º–º–∏—Ç

```bash
git add .
git commit -m "feat: unify role format to uppercase ADMIN"
git push
```

### 4Ô∏è‚É£ Pull Request

- –û–ø–∏—Å–∞–Ω–∏–µ: —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∏ –ø–æ—á–µ–º—É
- Review: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ —Ç–µ—Å—Ç–æ–≤

### 5Ô∏è‚É£ –î–µ–ø–ª–æ–π

- GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç tests + build
- Merge ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ Vercel

---

## üéØ –ö–ï–ô –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:

- ‚úÖ 100% type coverage (TypeScript –±–µ–∑ `any`)
- ‚úÖ 80%+ test coverage
- ‚úÖ 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö security issues
- ‚úÖ < 3s page load time
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 100+ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–Ω–∞–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ 99.9% uptime –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

## üìö –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –†–ï–°–£–†–°–´

1. **Next.js Best Practices**: https://nextjs.org/docs/app/building-your-application/routing/middleware
2. **Prisma Documentation**: https://www.prisma.io/docs/
3. **Zod Validation**: https://zod.dev
4. **Stripe Integration**: https://stripe.com/docs
5. **SaaS Architecture Patterns**: https://newsletter.getdx.com/
6. **Testing Best Practices**: https://kentcdodds.com/blog

---

## üö® –î–ï–ô–°–¢–í–ò–Ø –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

### –ù–µ–¥–µ–ª—è 1-2 (–§–û–ö–£–°):

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å role —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—é** ‚Üí —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –±–µ–∑ —ç—Ç–æ–≥–æ
2. **–î–æ–±–∞–≤–∏—Ç—å .env.example** ‚Üí onboarding –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
3. **–ó–∞—â–∏—Ç–∏—Ç—å API endpoints** ‚Üí –Ω–µ–ª—å–∑—è –≤ prod –±–µ–∑ —ç—Ç–æ–≥–æ
4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é** ‚Üí —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ user issue

–≠—Ç–∏ 4 —Ç–∞—Å–∫–∞ –æ—Ç–∫—Ä–æ—é—Ç –¥–æ—Ä–æ–≥—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è SaaS —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.
